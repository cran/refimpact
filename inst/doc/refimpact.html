<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Perry Stephenson" />

<meta name="date" content="2017-07-19" />

<title>UK REF Impact Case Studies</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">UK REF Impact Case Studies</h1>
<h4 class="author"><em>Perry Stephenson</em></h4>
<h4 class="date"><em>2017-07-19</em></h4>



<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(refimpact)</code></pre></div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This package is an API wrapper around the REF Impact Case Studies database API. Chances are that if you’re looking at this package, you already know what this dataset is, and you probably know roughly what you’re looking for.</p>
<p>If you have stumbled upon this package however, and you want to know more about the dataset, you can head <a href="http://impact.ref.ac.uk">here</a> to find out more. If you are thinking of using this dataset as a toy dataset for learning, then you might find this dataset useful for text mining, amongst other things.</p>
</div>
<div id="core-functions" class="section level2">
<h2>Core functions</h2>
<p>The core function for this package is <code>ref_get()</code>, which takes an API method as the first argument, and some optional arguments depending on the method.</p>
<p>The API methods available are detailed below, but presented here for quick reference:</p>
<ul>
<li>SearchCaseStudies</li>
<li>ListUnitsOfAssessment</li>
<li>ListTagTypes</li>
<li>ListTagValues</li>
<li>ListInstitutions</li>
</ul>
</div>
<div id="searchcasestudies" class="section level2">
<h2>SearchCaseStudies</h2>
<p>This is the core method of the API, and the most important for users of this package. The search method requires a compulsory argument to the <code>ref_get()</code> function: <code>query</code>. This argument takes a list of query parameters, which can be as simple as a single Case Study ID, which returns a single record. A query returning a single record is shown below to demonstrate the syntax and the returned data structure; more complex queries will be shown later in the vignette.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">ref_get</span>(<span class="st">&quot;SearchCaseStudies&quot;</span>, <span class="dt">query=</span><span class="kw">list</span>(<span class="dt">ID=</span><span class="dv">941</span>))
<span class="kw">print</span>(results)</code></pre></div>
<pre><code>## # A tibble: 1 x 19
##   CaseStudyId            Continent              Country   Funders
## *       &lt;chr&gt;               &lt;list&gt;               &lt;list&gt;    &lt;list&gt;
## 1         941 &lt;data.frame [2 x 2]&gt; &lt;data.frame [2 x 2]&gt; &lt;chr [3]&gt;
## # ... with 15 more variables: ImpactDetails &lt;chr&gt;, ImpactSummary &lt;chr&gt;,
## #   ImpactType &lt;chr&gt;, Institution &lt;chr&gt;, Institutions &lt;list&gt;, Panel &lt;chr&gt;,
## #   PlaceName &lt;list&gt;, References &lt;chr&gt;, ResearchSubjectAreas &lt;list&gt;,
## #   Sources &lt;chr&gt;, Title &lt;chr&gt;, UKLocation &lt;list&gt;, UKRegion &lt;list&gt;,
## #   UOA &lt;chr&gt;, UnderpinningResearch &lt;chr&gt;</code></pre>
<p>You will note that the function returns a nested tibble - that is a tibble with other data frames inside it. This means that you can interrogate the tibble as per usual:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(results[[<span class="dv">1</span>, <span class="st">&quot;CaseStudyId&quot;</span>]])</code></pre></div>
<pre><code>## 941</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(results[[<span class="dv">1</span>, <span class="st">&quot;Title&quot;</span>]])</code></pre></div>
<pre><code>## 
## Novel models for advanced imaging of urinary system function in healthy and diseased tissue.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="kw">strtrim</span>(results[[<span class="dv">1</span>, <span class="st">&quot;ImpactSummary&quot;</span>]], <span class="dt">width =</span> <span class="dv">200</span>), <span class="st">&quot;&lt;truncated&gt;&quot;</span>)</code></pre></div>
<pre><code>## 
## Drs Peppiatt-Wildman &amp;amp; Wildman have developed novel models to investigate kidney and bladder
## function and drug action, through visualisation of cellular events in live tissue. This has had an
##  &lt;truncated&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="kw">strtrim</span>(results[[<span class="dv">1</span>, <span class="st">&quot;ImpactDetails&quot;</span>]], <span class="dt">width =</span> <span class="dv">200</span>), <span class="st">&quot;&lt;truncated&gt;&quot;</span>)</code></pre></div>
<pre><code>## 
## Impact on Commerce
## Peppiatt-Wildman and Wildman's unique approaches to investigate kidney and bladder function in
## a range of experimental models, including tissue slices, isolated and perfused org &lt;truncated&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(results[[<span class="dv">1</span>, <span class="st">&quot;Institution&quot;</span>]])</code></pre></div>
<pre><code>## 
## University of Kent and University of Greenwich</code></pre>
<p>You can also interrogate the nested fields the same way, and even subset them:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(results[[<span class="dv">1</span>, <span class="st">&quot;Country&quot;</span>]])</code></pre></div>
<pre><code>##   GeoNamesId           Name
## 1    2635167 United Kingdom
## 2    6252001  United States</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(results[[<span class="dv">1</span>, <span class="st">&quot;Institutions&quot;</span>]])</code></pre></div>
<pre><code>##             AlternativeName         InstitutionName PeerGroup     Region
## 1 Greenwich (University of) University of Greenwich         D     London
## 2      Kent (University of)      University of Kent         B South East
##      UKPRN
## 1 10007146
## 2 10007150</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(results[[<span class="dv">1</span>, <span class="st">&quot;Institutions&quot;</span>]][,<span class="kw">c</span>(<span class="st">&quot;UKPRN&quot;</span>, <span class="st">&quot;InstitutionName&quot;</span>)])</code></pre></div>
<pre><code>##      UKPRN         InstitutionName
## 1 10007146 University of Greenwich
## 2 10007150      University of Kent</code></pre>
<blockquote>
<p><em>In the opinion of the package author, the nested tibble offers many advantages over other data representations - it is a relatively straight-forward exercise to transform the data into a set of wide or narrow tables if required.</em></p>
</blockquote>
<p>Returning a single case study based on the ID is obviously a niche use-case, so there are some other ways to search the database. But before getting to those, it is worth pointing out that you can select multiple case studies in a single query:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">ref_get</span>(<span class="st">&quot;SearchCaseStudies&quot;</span>, <span class="dt">query=</span><span class="kw">list</span>(<span class="dt">ID=</span><span class="kw">c</span>(<span class="dv">941</span>, <span class="dv">942</span>, <span class="dv">1014</span>)))
<span class="kw">print</span>(results)</code></pre></div>
<pre><code>## # A tibble: 3 x 19
##   CaseStudyId            Continent              Country   Funders
## *       &lt;chr&gt;               &lt;list&gt;               &lt;list&gt;    &lt;list&gt;
## 1         941 &lt;data.frame [2 x 2]&gt; &lt;data.frame [2 x 2]&gt; &lt;chr [3]&gt;
## 2         942 &lt;data.frame [2 x 2]&gt; &lt;data.frame [2 x 2]&gt; &lt;chr [3]&gt;
## 3        1014 &lt;data.frame [0 x 0]&gt; &lt;data.frame [0 x 0]&gt; &lt;chr [0]&gt;
## # ... with 15 more variables: ImpactDetails &lt;chr&gt;, ImpactSummary &lt;chr&gt;,
## #   ImpactType &lt;chr&gt;, Institution &lt;chr&gt;, Institutions &lt;list&gt;, Panel &lt;chr&gt;,
## #   PlaceName &lt;list&gt;, References &lt;chr&gt;, ResearchSubjectAreas &lt;list&gt;,
## #   Sources &lt;chr&gt;, Title &lt;chr&gt;, UKLocation &lt;list&gt;, UKRegion &lt;list&gt;,
## #   UOA &lt;chr&gt;, UnderpinningResearch &lt;chr&gt;</code></pre>
<p>The ID parameter above is an exclusive parameter - if you provide one or more IDs then the function will print a warning to the console, and remove all parameters except for the IDs. This is based on the API’s documented limitations.</p>
<p>The other parameters can all be combined for searching. Those parameters are:</p>
<ul>
<li><strong>UKPRN</strong> - This is a code referencing an institution, and comes from the ListInstitutions method below. Takes a single UKPRN.</li>
<li><strong>UoA</strong> - This is a code referencing a Unit of Assessment, and comes from the ListUnitsOfAssessment method below. Takes a single ID.</li>
<li><strong>tags</strong> - This is one or more codes referencing tags from the ListTagValues method. The tags are separated into 13 different TagTypes, which are detailed below. When multiple tags are provided to the search method, it will only return rows which contain both tags.</li>
<li><strong>phrase</strong> - You can search the database using a text query. The query must conform to Lucene search query syntax.</li>
</ul>
<p>Some examples are shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">ref_get</span>(<span class="st">&quot;SearchCaseStudies&quot;</span>, <span class="dt">query=</span><span class="kw">list</span>(<span class="dt">UKPRN =</span> <span class="dv">10007777</span>))
<span class="kw">dim</span>(results)</code></pre></div>
<pre><code>## [1]  7 19</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">ref_get</span>(<span class="st">&quot;SearchCaseStudies&quot;</span>, <span class="dt">query=</span><span class="kw">list</span>(<span class="dt">UoA =</span> <span class="dv">5</span>))
<span class="kw">dim</span>(results)</code></pre></div>
<pre><code>## [1] 257  19</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">ref_get</span>(<span class="st">&quot;SearchCaseStudies&quot;</span>, <span class="dt">query=</span><span class="kw">list</span>(<span class="dt">tags =</span> <span class="kw">c</span>(<span class="dv">11280</span>, <span class="dv">5085</span>)))
<span class="kw">dim</span>(results)</code></pre></div>
<pre><code>## [1] 24 19</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">ref_get</span>(<span class="st">&quot;SearchCaseStudies&quot;</span>, <span class="dt">query=</span><span class="kw">list</span>(<span class="dt">phrase =</span> <span class="st">&quot;hello&quot;</span>))
<span class="kw">dim</span>(results)</code></pre></div>
<pre><code>## [1]  7 19</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">ref_get</span>(<span class="st">&quot;SearchCaseStudies&quot;</span>, <span class="dt">query=</span><span class="kw">list</span>(<span class="dt">UKPRN =</span> <span class="dv">10007146</span>,
                                                   <span class="dt">UoA   =</span> <span class="dv">3</span>))
<span class="kw">dim</span>(results)</code></pre></div>
<pre><code>## [1]  2 19</code></pre>
<p>Unfortunately, the API method requires at least one search parameter, which makes it more difficult to download the entire dataset. A short script for this purpose is included at the end of this vignette.</p>
<p>Useful values for the UKPRN, UoA and tags parameters can be found by querying the other 4 API methods - the phrase parameter is the only parameter which can be used in isolation. Each of the 4 other API methods are outlined below.</p>
</div>
<div id="listinstitutions" class="section level2">
<h2>ListInstitutions</h2>
<p>This method lists all of the institutions which are included in the REF Impact Case Studies database, and the UKPRN column in the resuling tibble can be used as a query parameter</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">institutions &lt;-<span class="st"> </span><span class="kw">ref_get</span>(<span class="st">&quot;ListInstitutions&quot;</span>)
<span class="kw">print</span>(institutions)</code></pre></div>
<pre><code>## # A tibble: 155 x 5
##                             AlternativeName
##  *                                    &lt;chr&gt;
##  1                          Open University
##  2                     Cranfield University
##  3                     Royal College of Art
##  4            Bishop Grosseteste University
##  5           Buckinghamshire New University
##  6 Royal Central School of Speech and Drama
##  7                  Chester (University of)
##  8      Canterbury Christ Church University
##  9                  York St John University
## 10                     Edge Hill University
## # ... with 145 more rows, and 4 more variables: InstitutionName &lt;chr&gt;,
## #   PeerGroup &lt;chr&gt;, Region &lt;chr&gt;, UKPRN &lt;int&gt;</code></pre>
</div>
<div id="listtagtypes-and-listtagvalues" class="section level2">
<h2>ListTagTypes and ListTagValues</h2>
<p>These methods provide tags which can be used as search parameters in the SearchCaseStudies method. The ListTagTypes method returns the types of tags available:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tag_types &lt;-<span class="st"> </span><span class="kw">ref_get</span>(<span class="st">&quot;ListTagTypes&quot;</span>)
<span class="kw">print</span>(tag_types)</code></pre></div>
<pre><code>## # A tibble: 13 x 2
##       ID              TagType
##  * &lt;int&gt;                &lt;chr&gt;
##  1     1           ImpactType
##  2     3              Subject
##  3     4            PlaceName
##  4     5              Country
##  5     6            Continent
##  6     7    Interdisciplinary
##  7     8              Similar
##  8     9               Funder
##  9    10                Panel
## 10    11    InstitutionRegion
## 11    12 InstitutionPeerGroup
## 12    13            UK Region
## 13    15     Joint Submission</code></pre>
<p>These tag types can then be used as an argument to the ListTagValues method, to get all tags for each type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tag_values_5 &lt;-<span class="st"> </span><span class="kw">ref_get</span>(<span class="st">&quot;ListTagValues&quot;</span>, <span class="dt">tag_type =</span> <span class="dv">5</span>)
<span class="kw">print</span>(tag_values_5)</code></pre></div>
<pre><code>## # A tibble: 252 x 2
##       ID                         Name
##  * &lt;int&gt;                        &lt;chr&gt;
##  1 11280                  Afghanistan
##  2 11310                Aland Islands
##  3 11116                      Albania
##  4 11106                      Algeria
##  5 25129 American Samoa, Territory of
##  6 11221                      Andorra
##  7 11185                       Angola
##  8 11301                     Anguilla
##  9 11187          Antigua and Barbuda
## 10 11328                    Argentina
## # ... with 242 more rows</code></pre>
<p>This can take some time to iterate through, so the full table is bundled with this package. You can access it via <code>ref_tags</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(ref_tags)</code></pre></div>
<pre><code>## # A tibble: 9,400 x 4
##       ID                                    Name TypeID    TagType
##  * &lt;int&gt;                                   &lt;chr&gt;  &lt;int&gt;      &lt;chr&gt;
##  1  5083                                Cultural      1 ImpactType
##  2  5086                                Economic      1 ImpactType
##  3  5087                           Environmental      1 ImpactType
##  4  5082                                  Health      1 ImpactType
##  5  5081                                   Legal      1 ImpactType
##  6  5080                               Political      1 ImpactType
##  7  5085                                Societal      1 ImpactType
##  8  5084                           Technological      1 ImpactType
##  9   911 Accounting, Auditing and Accountability      3    Subject
## 10  1022                   Aerospace Engineering      3    Subject
## # ... with 9,390 more rows</code></pre>
</div>
<div id="listunitsofassessment" class="section level2">
<h2>ListUnitsOfAssessment</h2>
<p>This method lists all of the units of assessment which the Impact Case Studies can be assessed against. The tibble also includes an ID column which can be used when querying the SearchCaseStudies method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">UoAs &lt;-<span class="st"> </span><span class="kw">ref_get</span>(<span class="st">&quot;ListUnitsOfAssessment&quot;</span>)
<span class="kw">print</span>(UoAs)</code></pre></div>
<pre><code>## # A tibble: 36 x 3
##       ID      Panel
##  * &lt;int&gt;      &lt;chr&gt;
##  1     1 A         
##  2     2 A         
##  3     3 A         
##  4     4 A         
##  5     5 A         
##  6     6 A         
##  7     7 B         
##  8     8 B         
##  9     9 B         
## 10    10 B         
## # ... with 26 more rows, and 1 more variables: Subject &lt;chr&gt;</code></pre>
</div>
<div id="extracting-the-entire-dataset" class="section level2">
<h2>Extracting the entire dataset</h2>
<p>As alluded to above, the API cannot be searched without parameters, which means that downloading the entire dataset is not a simple task. The code below can be used to extract all records from the database.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">uoa_table &lt;-<span class="st"> </span><span class="kw">ref_get</span>(<span class="st">&quot;ListUnitsOfAssessment&quot;</span>)
uoa_list &lt;-<span class="st"> </span>uoa_table$ID

ref_corpus &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">length =</span> <span class="kw">length</span>(uoa_list), <span class="dt">mode =</span> <span class="st">&quot;list&quot;</span>)

for (i in <span class="kw">seq_along</span>(uoa_list)) {
  <span class="kw">message</span>(<span class="st">&quot;Retrieving data for UoA &quot;</span>, uoa_list[i])
  ref_corpus[[i]] &lt;-<span class="st"> </span><span class="kw">ref_get</span>(<span class="st">&quot;SearchCaseStudies&quot;</span>, <span class="dt">query =</span> <span class="kw">list</span>(<span class="dt">UoA =</span> uoa_list[i]))
}

output &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, ref_corpus)</code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
